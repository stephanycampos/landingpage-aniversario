(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9855],{97210:function(e,t,n){"use strict";n.d(t,{K:function(){return J}});var i=n(2844),r=n(35835),a=n(24666),l=n(34587),o=n.n(l),s=n(55941),c=n(15129),d=n(80173),u=n(68339),h=n(56176),v=n(14066),f=n(38682),x=n(44886),p=n(63666),m=n(58498),j=n(53925),b=n(35658),g=n(33894),y=x.ZP.table.withConfig({displayName:"Table",componentId:"sc-10p49ff-0"})(["width:100%;margin:16px 0;thead tr td{padding-bottom:12px;}}tr{width:100%;border-bottom:",";}td{text-align:left;vertical-align:middle;padding:",";&:last-child{text-align:right;}a{color:",";}}"],(function(e){return e.border?g.rS.border.default:"none"}),(function(e){return e.compact?e.border?"8px 0":"4px 0":e.border?"24px 0":"16px 0"}),g.rS.colors.active),w=n(66542),k=n(2532),O=n(49728),D=n(94271),C=function(e){var t,n=e.collectionEditingState,i=e.style,a=e.teamId,l=(0,s.useState)(!1),c=l[0],d=l[1],u=n.data,h=(0,w.nh)(null!==(t=null===u||void 0===u?void 0:u.id)&&void 0!==t?t:null),v=h.data,f=h.loading,x=h.refresh;return u?!v&&f?(0,D.jsx)("div",{style:{padding:24},children:(0,D.jsx)(b.T,{})}):(0,D.jsxs)(P,{border:!0,style:i,children:[(0,D.jsx)("thead",{children:(0,D.jsxs)("tr",{children:[(0,D.jsx)("td",{}),(0,D.jsx)("td",{children:(0,D.jsx)("small",{children:"Name"})}),(0,D.jsx)("td",{children:(0,D.jsx)("small",{children:"Created"})}),(0,D.jsx)("td",{children:(0,D.jsx)("small",{children:"Published"})}),(0,D.jsx)("td",{children:(0,D.jsx)("small",{children:"Actions"})})]})}),(0,D.jsx)("tbody",{children:null===v||void 0===v?void 0:v.versions.map((function(e){var t=v.publishedVersion===e.version;return(0,D.jsxs)(I,{onClick:function(){(0,k.ZJ)(a,v.id,e.version)},$active:e.version===u.version,children:[(0,D.jsx)("td",{style:{padding:8},children:(0,D.jsxs)("small",{children:["v",e.version]})}),(0,D.jsx)("td",{children:(0,D.jsx)("div",{children:(0,D.jsxs)("small",{children:[e.numberOfMasters," Masters,"," ",e.numberOfComponents," Components"]})})}),(0,D.jsx)("td",{children:(0,D.jsx)("small",{children:(0,O.HW)(e.createdAt)})}),(0,D.jsx)("td",{children:(0,D.jsx)(j.du,{style:{justifyContent:"center"},children:(0,D.jsx)("small",{children:t?(0,D.jsx)(j.du,{$gap:"8px",style:{justifyContent:"start"},children:(0,D.jsx)(p.J,{type:"check",color:"success"})}):e.wasPublished?(0,D.jsx)(j.du,{$gap:"8px",style:{justifyContent:"start"},children:(0,D.jsx)(p.J,{type:"check",color:"ink-100"})}):"No"})})}),(0,D.jsx)("td",{children:(0,D.jsx)(j.du,{style:{justifyContent:"center"},children:(0,D.jsx)(m.z,{variant:t?"danger":"secondary",size:"sm",disabled:c,onClick:(0,r.Z)(o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return d(!0),t.next=3,n.handlePublish(e.version);case 3:x(),d(!1);case 5:case"end":return t.stop()}}),t)}))),children:t?"Unpublish":"Publish"})})})]},e.version)}))})]}):null},P=(0,x.ZP)(y).withConfig({displayName:"History__StyledTable",componentId:"sc-19fbvnx-0"})(["width:100%;max-width:100%;margin-top:0;"]),I=x.ZP.tr.withConfig({displayName:"History__Tr",componentId:"sc-19fbvnx-1"})([":hover td{background:",";cursor:pointer;}td{background:",";padding:12px 8px;}"],(function(e){return e.$active?g.rS.colors.active:g.rS.colors.lightest}),(function(e){return e.$active?g.rS.colors.active:g.rS.colors.white})),S=n(1152),N=n(56540),_=n(34149),Z=n(76841),E=n(86710),T=n(91168),A=n(77166),z=n(68748),M=n(52838);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function B(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var J=function(e){var t,n,l=e.collectionId,x=e.initialCollectionData,j=e.teamId,b=(0,c.useRouter)(),g=(0,_.p)(),y=(0,s.useState)(!1),O=y[0],P=y[1],I=(0,w.Kx)(l,x),U=I.data,J=(0,w.nh)(null!==(t=null===U||void 0===U?void 0:U.id)&&void 0!==t?t:null).data,K=b.route.startsWith("/collections/"),V=(null===J||void 0===J?void 0:J.publishedVersion)===(null===U||void 0===U?void 0:U.version),$=Math.max.apply(Math,(0,a.Z)(null!==(n=null===J||void 0===J?void 0:J.versions.map((function(e){return e.version})))&&void 0!==n?n:[]))===(null===U||void 0===U?void 0:U.version),H=!(null!==U&&void 0!==U&&U.archived)&&!V&&$,R=!V&&!$,W=(0,N.bu)(N.s);return U?(0,D.jsx)(u.g,{className:"dark",children:(0,D.jsxs)("div",{className:"flex w-full items-center justify-between",children:[(0,D.jsxs)(A.K,{gap:2,className:"items-center",children:[(0,D.jsx)(h.O,{darkMode:!0}),(0,D.jsx)(m.z,{variant:"naked",iconLeft:"close",onClick:k.SD,children:"Exit Editor Mode"})]}),U&&(0,D.jsxs)(A.K,{gap:4,className:"items-center",children:[U.archived&&(0,D.jsx)(D.Fragment,{children:"This collection has been archived"}),V&&(0,D.jsxs)(A.K,{gap:2,className:"items-center mr-4",children:[(0,D.jsx)("span",{children:"Published"}),(0,D.jsx)(p.J,{type:"check",className:"success"})]}),R&&(0,D.jsxs)(z.x,{color:"current",children:["Viewing an old version (v",null===U||void 0===U?void 0:U.version,")"]}),H&&(0,D.jsx)(m.z,{size:"lg",variant:"active",onClick:function(){I.handlePublish()},children:"Publish"}),K&&(0,D.jsx)(m.z,{size:"xl",variant:"secondary",disabled:O,onClick:(0,r.Z)(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(W&&I.data){e.next=2;break}return e.abrupt("return");case 2:return e.prev=2,P(!0),e.next=6,(0,E.E)(W);case 6:if(!("error"in(t=e.sent))){e.next=9;break}throw new Error(t.error);case 9:return n="".concat(W.blushData.modificationOptions.id,"/").concat(W.blushData.modificationOptions.value),r=B(B({},I.data.thumbnails),{},(0,i.Z)({},n,t.imageId)),e.next=13,(0,T.ER)(I.data.id,I.data.version,{thumbnails:r});case 13:e.next=19;break;case 15:e.prev=15,e.t0=e.catch(2),g({type:"SHOW_TOAST",payload:{type:"error",message:e.t0.message}}),d.Tb(e.t0);case 19:return e.prev=19,P(!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[2,15,19,22]])}))),children:"Update Thumbnail"}),(0,D.jsx)(f.Y,{menuButton:(0,D.jsx)(m.z,{size:"lg",variant:"secondary",children:"Versions"}),children:(0,D.jsx)(S.xr,{$enabled:!0,style:{padding:8,maxHeight:"80vh",width:"50vw"},children:(0,D.jsx)(C,{collectionEditingState:I,teamId:j})})}),(0,D.jsx)(v.v2,{options:[U.archived?{label:"Restore Collection",value:"restore"}:{label:"Archive Collection",value:"archive"}].filter(Z.Dw),onClick:function(e){switch(e.value){case"archive":I.handleArchive();break;case"restore":I.handleRestore()}},menuButton:function(){return(0,D.jsx)(M.h,{size:"lg",icon:"veganMeatballs"})}})]})]})}):null}},17895:function(e,t,n){"use strict";n.r(t),n.d(t,{PageMetaData:function(){return w},__N_SSP:function(){return y},default:function(){return k}});var i=n(31367),r=n(36365),a=n(55941),l=n(15129),o=n.n(l);var s=n(1152),c=n(26765),d=n(19052),u=n(70354),h=n(57821),v=n(97210),f=n(56540),x=n(61395),p=n(87301),m=n(2532),j=n(39097),b=n(94271);function g(){var e=(0,x.Z)().lang,t=(0,f.bu)(f.s),n=(0,f.bu)(f.uf),i=(0,p.Z)(u.IQ,250).callback;return(0,a.useEffect)((function(){var n;if(t){var r=(null===(n=o().query.shareUri)||void 0===n?void 0:n[0])===t.blushData.shareUri;i(t.blushData,e,r)}}),[t,n,e,i]),null}var y=!0,w=function(e){var t,n,i=e.initialBlushData,r=(0,f.bu)(f.s),a=(null===r||void 0===r?void 0:r.blushData)||i,l=(0,h.A)(a);return(0,b.jsx)(c.U,{title:"".concat(a.collection.name).concat(null!==(t=a.metadata)&&void 0!==t&&t.artistName?" - Illustration by ".concat(null===(n=a.metadata)||void 0===n?void 0:n.artistName):""),description:"Check out this illustration on Blush.",twitterUrl:a.collection.artistTwitter,ogImage:l()})},k=function(e){var t,n=e.initialBlushData,o=e.error,c=(0,l.useRouter)(),u=((0,j.GI)(),(0,x.Z)().t),h=(t=c.query.shareUri,(Array.isArray(t)?t.length<=1&&!t[0]:!t)||n?"":"Not Found"),p=h||u("common:error-generating-illustration"),y=(0,a.useState)(null),k=y[0],O=y[1];return(0,a.useEffect)((function(){var e=(0,m.tV)(null===n||void 0===n?void 0:n.collection.id);O(e)}),[null===n||void 0===n?void 0:n.collection.id]),o||h?(0,b.jsx)(r.m,{message:p}):n?(0,b.jsx)(f.ZP,{initialBlushData:n,children:(0,b.jsxs)(d.Z,{container:s.fC,header:k?(0,b.jsx)(v.K,{collectionId:k.collectionData.id,initialCollectionData:k.collectionData,teamId:k.teamId}):null,children:[(0,b.jsx)(w,{initialBlushData:n}),(0,b.jsx)(i.L,{}),(0,b.jsx)(g,{})]})}):(0,b.jsx)(d.Z,{container:s.fC,children:(0,b.jsx)(i.I,{})})}},2532:function(e,t,n){"use strict";n.d(t,{SD:function(){return d},ZJ:function(){return c},tG:function(){return s},tV:function(){return u}});var i=n(74793),r=n(15129),a=n.n(r),l=n(10009),o=n(76841);function s(e){var t=e.collectionData,n=e.teamId;i.ZP.setItem(l.uA,JSON.stringify({collectionData:t,teamId:n}))}function c(e,t,n){a().push("/team/".concat(e,"/collections/").concat(t,"/edit/").concat(n))}function d(){var e=u();i.ZP.removeItem(l.uA),a().push(e?"/team/".concat(e.teamId,"/collections/").concat(e.collectionData.id):"/collections")}function u(e){try{var t=i.ZP.getItem(l.uA),n=t?JSON.parse(t):null;if(!(0,o.iC)(n.collectionData))return null;var r=e?n.collectionData&&n.collectionData.id===e:null;return!e||r?n:null}catch(a){return null}}},61929:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/collections/[collectionId]/[collectionSlug]/[...shareUri]",function(){return n(17895)}])}},function(e){e.O(0,[9375,523,1726,9774,2888,179],(function(){return t=61929,e(e.s=t);var t}));var t=e.O();_N_E=t}]);